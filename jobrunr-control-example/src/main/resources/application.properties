#
# Quarkus HTTP Configuration (see https://quarkus.io/guides/http-reference)
#
# Max form attribute size: Maximum size for form data attributes (default: 2KB)
# Increased to handle large form submissions with multiple parameters
quarkus.http.limits.max-form-attribute-size=10M
#
# JobRunr Configuration (see https://www.jobrunr.io/en/documentation/configuration/quarkus/)
#
# Background Job Server: Processes scheduled jobs
quarkus.jobrunr.background-job-server.enabled=true
quarkus.jobrunr.background-job-server.worker-count=20
# Job Scheduler: Enables job scheduling capabilities
quarkus.jobrunr.job-scheduler.enabled=true
# Metrics: Enable job execution metrics and Micrometer timers
quarkus.jobrunr.jobs.metrics.enabled=true
quarkus.jobrunr.jobs.metrics.micrometer-timers.enabled=true
#
# JobRunr Dashboard Settings (see https://www.jobrunr.io/en/documentation/configuration/dashboard/)
#
# Dashboard type: 'embedded' (runs on same port) or 'standalone' (runs on separate port, default 8000)
quarkus.jobrunr.dashboard.enabled=true
quarkus.jobrunr.dashboard.type=embedded
quarkus.jobrunr.dashboard.context-path=/q/jobrunr
#
# Database Configuration (see https://quarkus.io/guides/datasource)
#
# PostgreSQL for dev mode (use ./start-postgres.sh to start)
%dev.quarkus.datasource.db-kind=postgresql
%dev.quarkus.datasource.username=postgres
%dev.quarkus.datasource.password=your_strong_password
%dev.quarkus.datasource.jdbc.url=jdbc:postgresql://localhost:5432/postgres
%dev.quarkus.datasource.jdbc.max-size=16
#
# Test mode uses H2 in-memory for fast tests
%test.quarkus.datasource.db-kind=h2
%test.quarkus.datasource.jdbc.url=jdbc:h2:mem:test
#
# Production - Datasource must be configured via environment variables or config file
# Example environment variables:
#   QUARKUS_DATASOURCE_DB_KIND=postgresql
#   QUARKUS_DATASOURCE_USERNAME=prod_user
#   QUARKUS_DATASOURCE_PASSWORD=prod_password
#   QUARKUS_DATASOURCE_JDBC_URL=jdbc:postgresql://prod-server:5432/jobrunr_db
#
# For build purposes, we configure a dummy datasource to satisfy build-time checks
# This will be overridden at runtime by environment variables
%prod.quarkus.datasource.db-kind=postgresql
%prod.quarkus.datasource.jdbc.url=jdbc:postgresql://localhost:5432/postgres
#
# Hibernate ORM Configuration (see https://quarkus.io/guides/hibernate-orm)
#
# Required when any job uses @JobParameterSet annotation for external parameter storage
# Schema management is handled by Flyway
%dev.quarkus.hibernate-orm.schema-management.strategy=update
%dev.quarkus.hibernate-orm.log.sql=true
%dev.quarkus.hibernate-orm.packages=ch.css.jobrunr.control.infrastructure.persistence
#
# Test mode - H2 in-memory database
%test.quarkus.hibernate-orm.schema-management.strategy=update
%test.quarkus.hibernate-orm.log.sql=false
%test.quarkus.hibernate-orm.packages=ch.css.jobrunr.control.infrastructure.persistence
#
# Production - Hibernate ORM enabled, schema managed by Flyway
%prod.quarkus.hibernate-orm.schema-management.strategy=verify
%prod.quarkus.hibernate-orm.packages=ch.css.jobrunr.control.infrastructure.persistence
#
# Flyway Configuration (see https://quarkus.io/guides/flyway)
#
# Enable Flyway migrations on startup (manages schema instead of Hibernate)
%dev.quarkus.flyway.migrate-at-start=true
%test.quarkus.flyway.migrate-at-start=true
# Include JobRunr Control parameter storage migrations from extension
%dev.quarkus.flyway.locations=classpath:db/migration/jobrunr-control
%test.quarkus.flyway.locations=classpath:db/migration/jobrunr-control
# Baseline for existing databases
%dev.quarkus.flyway.baseline-on-migrate=true
%test.quarkus.flyway.baseline-on-migrate=true
# Clean database on test start for reproducible tests
%test.quarkus.flyway.clean-at-start=true
#
# Production Flyway - migrations should be run manually or via CI/CD
# Set to true if you want automatic migrations in production (not recommended)
%prod.quarkus.flyway.migrate-at-start=false
%prod.quarkus.flyway.locations=classpath:db/migration/jobrunr-control
#
# Logging Configuration (see https://quarkus.io/guides/logging)
#
quarkus.log.category."ch.css.jobrunr".level=DEBUG
quarkus.log.category."org.jobrunr".level=INFO
#
# API metadata
#
mp.openapi.extensions.smallrye.info.title=JobRunr Control API
mp.openapi.extensions.smallrye.info.version=1.0.0
mp.openapi.extensions.smallrye.info.description=REST API for JobRunr Pro Scheduler Extension
mp.openapi.extensions.smallrye.info.contact.name=JobRunr Control Team
#
# Development Profile Settings
#
# Test roles for development mode
dev.test.roles=admin

